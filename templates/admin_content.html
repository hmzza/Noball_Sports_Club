<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Manager - Admin Panel</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modern-components.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        body {
            background: #f5f7fb;
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        .content-shell {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem 2.5rem;
        }
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
            gap: 1.25rem;
            align-items: flex-start;
        }
        .panel {
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 10px 30px rgba(17, 24, 39, 0.08);
            padding: 1.5rem;
        }
        .panel h2 {
            margin: 0 0 0.25rem;
            font-size: 1.35rem;
            color: #0f172a;
        }
        .panel .hint {
            color: #64748b;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }
        .stack {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .field {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        .field label {
            font-weight: 600;
            color: #334155;
            font-size: 0.95rem;
        }
        .field input,
        .field textarea {
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 0.85rem 1rem;
            font-size: 0.95rem;
            color: #0f172a;
            background: #f8fafc;
            transition: border 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
        }
        .field input:focus,
        .field textarea:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.12);
            background: #fff;
        }
        .field textarea { resize: vertical; min-height: 110px; }
        .field input[type="file"] {
            padding: 0.75rem 1rem;
            background: #fff;
        }
        .actions {
            display: flex;
            gap: 0.75rem;
            align-items: center;
            margin-top: 0.5rem;
        }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.9rem 1.25rem;
            border-radius: 12px;
            border: none;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.15s ease, box-shadow 0.2s ease, background 0.2s ease;
        }
        .btn-primary {
            background: linear-gradient(120deg, #2563eb, #1d4ed8);
            color: #fff;
            box-shadow: 0 12px 30px rgba(37, 99, 235, 0.25);
        }
        .btn-ghost {
            background: #eef2ff;
            color: #1d4ed8;
        }
        .btn:hover { transform: translateY(-1px); }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .list {
            margin-top: 1.25rem;
            display: grid;
            gap: 0.75rem;
        }
        .item {
            border: 1px solid #e2e8f0;
            border-radius: 14px;
            padding: 0.9rem;
            display: grid;
            grid-template-columns: 72px 1fr auto;
            gap: 0.9rem;
            align-items: center;
        }
        .thumb {
            width: 72px;
            height: 72px;
            border-radius: 12px;
            background: #f1f5f9;
            object-fit: cover;
        }
        .item-content h4 {
            margin: 0 0 0.15rem;
            color: #0f172a;
            font-size: 1rem;
        }
        .item-content p {
            margin: 0;
            color: #64748b;
            font-size: 0.9rem;
        }
        .chip {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.35rem 0.65rem;
            background: #eef2ff;
            color: #4338ca;
            border-radius: 999px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        .muted {
            color: #94a3b8;
            font-size: 0.85rem;
        }
        .empty {
            border: 1px dashed #cbd5e1;
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            color: #94a3b8;
        }
        @media (max-width: 640px) {
            .item { grid-template-columns: 56px 1fr; }
            .item .actions { margin-left: auto; }
        }
    </style>
</head>
<body data-static-base="{{ url_for('static', filename='') }}">
    {% set page_title = "Content" %}
    {% set icon_class = "fas fa-images" %}
    {% set page_subtitle = "Manage corporate posts and homepage gallery" %}
    {% include 'admin_navbar.html' %}

    <main class="content-shell" id="content-root"
          data-corporate-endpoint="{{ url_for('admin_panel.api_corporate_events') }}"
          data-gallery-endpoint="{{ url_for('admin_panel.api_gallery') }}">

        <div class="content-grid">
            <section class="panel">
                <h2>Corporate Events</h2>
                <p class="hint">Post company spotlights with a hero image, logo, and a short blurb.</p>
                {% if storage_info and storage_info.mode %}
                    {% if storage_info.mode == 'spaces' %}
                        <p class="hint" style="margin-top:-0.5rem">
                            Upload storage: <strong>Spaces</strong> ({{ storage_info.bucket }} / {{ storage_info.region }})
                        </p>
                    {% else %}
                        <p class="hint" style="margin-top:-0.5rem; color:#b45309">
                            Upload storage: <strong>Local</strong> (not reliable on production). Set Spaces env vars to fix missing images.
                        </p>
                    {% endif %}
                {% endif %}

                <form id="corporate-form" class="stack" enctype="multipart/form-data" method="post">
                    <div class="field">
                        <label for="companyName">Company Name *</label>
                        <input type="text" id="companyName" name="companyName" placeholder="Acme Industries" required>
                    </div>
                    <div class="field">
                        <label for="eventTitle">Headline *</label>
                        <input type="text" id="eventTitle" name="title" placeholder="Team building under the stars" required>
                    </div>
                    <div class="field">
                        <label for="eventDesc">Details</label>
                        <textarea id="eventDesc" name="description" placeholder="Few lines about the experience and outcomes."></textarea>
                    </div>
                    <div class="field">
                        <label for="eventDate">Event Date (optional)</label>
                        <input type="date" id="eventDate" name="event_date">
                    </div>
                    <div class="field">
                        <label for="eventImage">Feature Image *</label>
                        <input type="file" id="eventImage" name="event_image" accept=".jpg,.jpeg,.png,.webp" required>
                    </div>
                    <div class="field">
                        <label for="logoImage">Company Logo</label>
                        <input type="file" id="logoImage" name="logo_image" accept=".jpg,.jpeg,.png,.webp">
                    </div>
                    <div class="actions">
                        <button class="btn btn-primary" type="submit">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span>Publish Event</span>
                        </button>
                        <span id="corporate-status" class="muted"></span>
                    </div>
                </form>

                <div class="list" id="corporate-list"></div>
            </section>

            <section class="panel">
                <h2>Gallery</h2>
                <p class="hint">Refresh homepage gallery with fresh visuals.</p>

                <form id="gallery-form" class="stack" enctype="multipart/form-data" method="post">
                    <div class="field">
                        <label for="galleryTitle">Title</label>
                        <input type="text" id="galleryTitle" name="title" placeholder="Night lights on the padel court">
                    </div>
                    <div class="field">
                        <label for="galleryDesc">Description</label>
                        <textarea id="galleryDesc" name="description" placeholder="Short caption shown on hover."></textarea>
                    </div>
                    <div class="field">
                        <label for="galleryImage">Image *</label>
                        <input type="file" id="galleryImage" name="image" accept=".jpg,.jpeg,.png,.webp" required>
                    </div>
                    <div class="actions">
                        <button class="btn btn-primary" type="submit">
                            <i class="fas fa-plus"></i>
                            <span>Add to Gallery</span>
                        </button>
                        <span id="gallery-status" class="muted"></span>
                    </div>
                </form>

                <div class="list" id="gallery-list"></div>
            </section>
        </div>
    </main>

    <script>
        window.__INITIAL_EVENTS__ = {{ (events or []) | tojson | safe }};
        window.__INITIAL_GALLERY__ = {{ (gallery_items or []) | tojson | safe }};
    </script>
    <script src="{{ url_for('static', filename='js/admin_content.js') }}"></script>
</body>
</html>
